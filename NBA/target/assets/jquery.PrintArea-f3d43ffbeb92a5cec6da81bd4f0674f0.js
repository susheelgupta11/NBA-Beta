(function(e){var t=0;var n={iframe:"iframe",popup:"popup"};var r={strict:"strict",loose:"loose",html5:"html5"};var i={mode:n.iframe,standard:r.html5,popHt:500,popWd:400,popX:200,popY:200,popTitle:"",popClose:false,extraCss:"",extraHead:"",retainAttr:["id","class","style"]};var s={};e.fn.printArea=function(n){e.extend(s,i,n);t++;var r="printArea_";e("[id^="+r+"]").remove();s.id=r+t;var u=e(this);var a=o.getPrintWindow();o.write(a.doc,u);setTimeout(function(){o.print(a)},1e3)};var o={print:function(t){var r=t.win;e(t.doc).ready(function(){r.focus();r.print();if(s.mode==n.popup&&s.popClose)setTimeout(function(){r.close()},2e3)})},write:function(e,t){e.open();e.write(o.docType()+"<html>"+o.getHead()+o.getBody(t)+"</html>");e.close()},docType:function(){if(s.mode==n.iframe)return"";if(s.standard==r.html5)return"<!DOCTYPE html>";var e=s.standard==r.loose?" Transitional":"";var t=s.standard==r.loose?"loose":"strict";return'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01'+e+'//EN" "http://www.w3.org/TR/html4/'+t+'.dtd">'},getHead:function(){var t="";var n="";if(s.extraHead)s.extraHead.replace(/([^,]+)/g,function(e){t+=e});e(document).find("link").filter(function(){var t=e(this).attr("rel");return e.type(t)==="undefined"==false&&t.toLowerCase()=="stylesheet"}).filter(function(){var t=e(this).attr("media");return e.type(t)==="undefined"||t==""||t.toLowerCase()=="print"||t.toLowerCase()=="all"}).each(function(){n+='<link type="text/css" rel="stylesheet" href="'+e(this).attr("href")+'" >'});if(s.extraCss)s.extraCss.replace(/([^,\s]+)/g,function(e){n+='<link type="text/css" rel="stylesheet" href="'+e+'">'});return"<head><title>"+s.popTitle+"</title>"+t+n+"</head>"},getBody:function(t){var n="";var r=s.retainAttr;t.each(function(){var t=o.getFormData(e(this));var i="";for(var s=0;s<r.length;s++){var u=e(t).attr(r[s]);if(u)i+=(i.length>0?" ":"")+r[s]+"='"+u+"'"}n+="<div "+i+">"+e(t).html()+"</div>"});return"<body>"+n+"</body>"},getFormData:function(t){var n=t.clone();var r=e("input,select,textarea",n);e("input,select,textarea",t).each(function(t){var n=e(this).attr("type");if(e.type(n)==="undefined")n=e(this).is("select")?"select":e(this).is("textarea")?"textarea":"";var i=r.eq(t);if(n=="radio"||n=="checkbox")i.attr("checked",e(this).is(":checked"));else if(n=="text")i.attr("value",e(this).val());else if(n=="select")e(this).find("option").each(function(t){if(e(this).is(":selected"))e("option",i).eq(t).attr("selected",true)});else if(n=="textarea")i.text(e(this).val())});return n},getPrintWindow:function(){switch(s.mode){case n.iframe:var e=new o.Iframe;return{win:e.contentWindow||e,doc:e.doc};case n.popup:var t=new o.Popup;return{win:t,doc:t.doc}}},Iframe:function(){var t=s.id;var n="border:0;position:absolute;width:0px;height:0px;right:0px;top:0px;";var r;try{r=document.createElement("iframe");document.body.appendChild(r);e(r).attr({style:n,id:t,src:"#"+(new Date).getTime()});r.doc=null;r.doc=r.contentDocument?r.contentDocument:r.contentWindow?r.contentWindow.document:r.document}catch(i){throw i+". iframes may not be supported in this browser."}if(r.doc==null)throw"Cannot find document.";return r},Popup:function(){var e="location=yes,statusbar=no,directories=no,menubar=no,titlebar=no,toolbar=no,dependent=no";e+=",width="+s.popWd+",height="+s.popHt;e+=",resizable=yes,screenX="+s.popX+",screenY="+s.popY+",personalbar=no,scrollbars=yes";var t=window.open("","_blank",e);t.doc=t.document;return t}}})(jQuery)