(function(){function e(){return!1}function t(e,t){var n,r=[];e.filterChildren(t);for(n=e.children.length-1;0<=n;n--)r.unshift(e.children[n]),e.children[n].remove();n=e.attributes;var i=e,s=!0,o;for(o in n)if(s)s=!1;else{var u=new CKEDITOR.htmlParser.element(e.name);u.attributes[o]=n[o];i.add(u);i=u;delete n[o]}for(n=0;n<r.length;n++)i.add(r[n])}var n,r,i,s=CKEDITOR.tools,o=["o:p","xml","script","meta","link"],u={},a=0;CKEDITOR.plugins.pastefromword={};CKEDITOR.cleanWord=function(c,h){var d=Boolean(c.match(/mso-list:\s*l\d+\s+level\d+\s+lfo\d+/));c=c.replace(/<!\[/g,"<!--[").replace(/\]>/g,"]-->");var y=CKEDITOR.htmlParser.fragment.fromHtml(c);i=new CKEDITOR.htmlParser.filter({root:function(e){e.filterChildren(i);CKEDITOR.plugins.pastefromword.lists.cleanup(n.createLists(e))},elementNames:[[/^\?xml:namespace$/,""],[/^v:shapetype/,""],[new RegExp(o.join("|")),""]],elements:{a:function(e){if(e.attributes.name){if("_GoBack"==e.attributes.name){delete e.name;return}if(e.attributes.name.match(/^OLE_LINK\d+$/)){delete e.name;return}}if(e.attributes.href&&e.attributes.href.match(/#.+$/)){var t=e.attributes.href.match(/#(.+)$/)[1];u[t]=e}e.attributes.name&&u[e.attributes.name]&&(e=u[e.attributes.name],e.attributes.href=e.attributes.href.replace(/.*#(.*)$/,"#$1"))},div:function(e){r.createStyleStack(e,i,h)},img:function(e){if(e.parent){var t=e.parent.attributes;(t=t.style||t.STYLE)&&t.match(/mso\-list:\s?Ignore/)&&(e.attributes["cke-ignored"]=!0)}r.mapStyles(e,{width:function(t){r.setStyle(e,"width",t+"px")},height:function(t){r.setStyle(e,"height",t+"px")}});e.attributes.src&&e.attributes.src.match(/^file:\/\//)&&e.attributes.alt&&e.attributes.alt.match(/^https?:\/\//)&&(e.attributes.src=e.attributes.alt)},p:function(e){e.filterChildren(i);if(e.attributes.style&&e.attributes.style.match(/display:\s*none/i))return!1;if(n.thisIsAListItem(e))n.convertToFakeListItem(e);else{var t=e.getAscendant(function(e){return"ul"==e.name||"ol"==e.name}),o=s.parseCssText(e.attributes.style);t&&!t.attributes["cke-list-level"]&&o["mso-list"]&&o["mso-list"].match(/level/)&&(t.attributes["cke-list-level"]=o["mso-list"].match(/level(\d+)/)[1])}r.createStyleStack(e,i,h)},pre:function(e){n.thisIsAListItem(e)&&n.convertToFakeListItem(e);r.createStyleStack(e,i,h)},h1:function(e){n.thisIsAListItem(e)&&n.convertToFakeListItem(e);r.createStyleStack(e,i,h)},font:function(e){if(e.getHtml().match(/^\s*$/))return(new CKEDITOR.htmlParser.text(" ")).insertAfter(e),!1;h&&!0===h.config.pasteFromWordRemoveFontStyles&&e.attributes.size&&delete e.attributes.size;t(e,i)},ul:function(e){if(d)return"li"==e.parent.name&&0===s.indexOf(e.parent.children,e)&&r.setStyle(e.parent,"list-style-type","none"),n.dissolveList(e),!1},li:function(e){d&&(e.attributes.style=r.normalizedStyles(e,h),r.pushStylesLower(e))},ol:function(e){if(d)return"li"==e.parent.name&&0===s.indexOf(e.parent.children,e)&&r.setStyle(e.parent,"list-style-type","none"),n.dissolveList(e),!1},span:function(e){e.filterChildren(i);e.attributes.style=r.normalizedStyles(e,h);if(!e.attributes.style||e.attributes.style.match(/^mso\-bookmark:OLE_LINK\d+$/)||e.getHtml().match(/^(\s|&nbsp;)+$/)){for(var t=e.children.length-1;0<=t;t--)e.children[t].insertAfter(e);return!1}r.createStyleStack(e,i,h)},table:function(e){e._tdBorders={};e.filterChildren(i);var t,n=0,s;for(s in e._tdBorders)e._tdBorders[s]>n&&(n=e._tdBorders[s],t=s);r.setStyle(e,"border",t)},td:function(e){var t=e.getAscendant("table"),n=t._tdBorders,i=["border","border-top","border-right","border-bottom","border-left"],t=s.parseCssText(t.attributes.style),o=t.background||t.BACKGROUND;o&&r.setStyle(e,"background",o,!0);(t=t["background-color"]||t["BACKGROUND-COLOR"])&&r.setStyle(e,"background-color",t,!0);var t=s.parseCssText(e.attributes.style),u;for(u in t)o=t[u],delete t[u],t[u.toLowerCase()]=o;for(u=0;u<i.length;u++)t[i[u]]&&(o=t[i[u]],n[o]=n[o]?n[o]+1:1);r.pushStylesLower(e,{background:!0})},"v:imagedata":e,"v:shape":function(e){var t=!1;e.parent.getFirst(function(n){"img"==n.name&&n.attributes&&n.attributes["v:shapes"]==e.attributes.id&&(t=!0)});if(t)return!1;var n="";e.forEach(function(e){e.attributes&&e.attributes.src&&(n=e.attributes.src)},CKEDITOR.NODE_ELEMENT,!0);e.filterChildren(i);e.name="img";e.attributes.src=e.attributes.src||n;delete e.attributes.type},style:function(){return!1}},attributes:{style:function(e,t){return r.normalizedStyles(t,h)||!1},"class":function(e){e=e.replace(/msonormal|msolistparagraph\w*/ig,"");return""===e?!1:e},cellspacing:e,cellpadding:e,border:e,valign:e,"v:shapes":e,"o:spid":e},comment:function(e){e.match(/\[if.* supportFields.*\]/)&&a++;"[endif]"==e&&(a=0<a?a-1:0);return!1},text:function(e){return a?"":e.replace(/&nbsp;/g," ")}});var b=new CKEDITOR.htmlParser.basicWriter;i.applyTo(y);y.writeHtml(b);return b.getHtml()};CKEDITOR.plugins.pastefromword.styles={setStyle:function(e,t,n,r){var i=s.parseCssText(e.attributes.style);r&&i[t]||(""===n?delete i[t]:i[t]=n,e.attributes.style=CKEDITOR.tools.writeCssText(i))},mapStyles:function(e,t){for(var n in t)if(e.attributes[n]){if("function"===typeof t[n])t[n](e.attributes[n]);else r.setStyle(e,t[n],e.attributes[n]);delete e.attributes[n]}},normalizedStyles:function(e,t){var r="background-color:transparent border-image:none color:windowtext direction:ltr mso- text-indent visibility:visible div:border:none".split(" "),i="font-family font font-size color background-color line-height text-decoration".split(" "),o=function(){for(var e=[],t=0;t<arguments.length;t++)arguments[t]&&e.push(arguments[t]);return-1!==s.indexOf(r,e.join(":"))},u=t&&!0===t.config.pasteFromWordRemoveFontStyles,a=s.parseCssText(e.attributes.style);"cke:li"==e.name&&a["TEXT-INDENT"]&&a.MARGIN&&(e.attributes["cke-indentation"]=n.getElementIndentation(e),a.MARGIN=a.MARGIN.replace(/(([\w\.]+ ){3,3})[\d\.]+(\w+$)/,"$10$3"));for(var l=s.objectKeys(a),c=0;c<l.length;c++){var h=l[c].toLowerCase(),p=a[l[c]],d=CKEDITOR.tools.indexOf;(u&&-1!==d(i,h.toLowerCase())||o(null,h,p)||o(null,h.replace(/\-.*$/,"-"))||o(null,h)||o(e.name,h,p)||o(e.name,h.replace(/\-.*$/,"-"))||o(e.name,h)||o(p))&&delete a[l[c]]}return CKEDITOR.tools.writeCssText(a)},createStyleStack:function(e,t,n){var i=[];e.filterChildren(t);for(t=e.children.length-1;0<=t;t--)i.unshift(e.children[t]),e.children[t].remove();r.sortStyles(e);t=s.parseCssText(r.normalizedStyles(e,n));n=e;var o="span"===e.name,u;for(u in t)if(!u.match(/margin|text\-align|width|border|padding/i))if(o)o=!1;else{var a=new CKEDITOR.htmlParser.element("span");a.attributes.style=u+":"+t[u];n.add(a);n=a;delete t[u]}"{}"!==JSON.stringify(t)?e.attributes.style=CKEDITOR.tools.writeCssText(t):delete e.attributes.style;for(t=0;t<i.length;t++)n.add(i[t])},sortStyles:function(e){for(var t=["border","border-bottom","font-size","background"],n=s.parseCssText(e.attributes.style),r=s.objectKeys(n),i=[],o=[],u=0;u<r.length;u++)-1!==s.indexOf(t,r[u].toLowerCase())?i.push(r[u]):o.push(r[u]);i.sort(function(e,n){var r=s.indexOf(t,e.toLowerCase()),i=s.indexOf(t,n.toLowerCase());return r-i});r=[].concat(i,o);i={};for(u=0;u<r.length;u++)i[r[u]]=n[r[u]];e.attributes.style=CKEDITOR.tools.writeCssText(i)},pushStylesLower:function(e,t){if(!e.attributes.style||0===e.children.length)return!1;t=t||{};var n={"list-style-type":!0,width:!0,border:!0,"border-":!0},i=s.parseCssText(e.attributes.style),o;for(o in i)if(!(o.toLowerCase()in n||n[o.toLowerCase().replace(/\-.*$/,"-")]||o.toLowerCase()in t)){for(var u=!1,a=0;a<e.children.length;a++){var f=e.children[a];f.type===CKEDITOR.NODE_ELEMENT&&(u=!0,r.setStyle(f,o,i[o]))}u&&delete i[o]}e.attributes.style=CKEDITOR.tools.writeCssText(i);return!0}};r=CKEDITOR.plugins.pastefromword.styles;CKEDITOR.plugins.pastefromword.lists={thisIsAListItem:function(e){return e.attributes.style&&e.attributes.style.match(/mso\-list:\s?l\d/)&&"li"!==e.parent.name||e.attributes["cke-dissolved"]||e.getHtml().match(/<!\-\-\[if !supportLists]\-\->/)||e.getHtml().match(/^( )*.*?[\.\)] ( ){2,666}/)?!0:!1},convertToFakeListItem:function(e){this.getListItemInfo(e);if(!e.attributes["cke-dissolved"]){var t;e.forEach(function(e){!t&&"img"==e.name&&e.attributes["cke-ignored"]&&"*"==e.attributes.alt&&(t="·",e.remove())},CKEDITOR.NODE_ELEMENT);e.forEach(function(e){t||e.value.match(/^ /)||(t=e.value)},CKEDITOR.NODE_TEXT);if("undefined"==typeof t)return;e.attributes["cke-symbol"]=t.replace(/ .*$/,"");n.removeSymbolText(e)}if(e.attributes.style){var r=s.parseCssText(e.attributes.style);r["margin-left"]&&(delete r["margin-left"],e.attributes.style=CKEDITOR.tools.writeCssText(r))}e.name="cke:li"},convertToRealListItems:function(e){var t=[];e.forEach(function(e){"cke:li"==e.name&&(e.name="li",t.push(e))},CKEDITOR.NODE_ELEMENT,!1);return t},removeSymbolText:function(e){var t,n=e.attributes["cke-symbol"];e.forEach(function(r){!t&&r.value.match(n.replace(")","\\)").replace("(",""))&&(r.value=r.value.replace(n,""),r.parent.getHtml().match(/^(\s|&nbsp;)*$/)&&(t=r.parent!==e?r.parent:null))},CKEDITOR.NODE_TEXT);t&&t.remove()},setListSymbol:function(e,t,r){r=r||1;var i=s.parseCssText(e.attributes.style);if("ol"==e.name){if(e.attributes.type||i["list-style-type"])return;var o={"[ivx]":"lower-roman","[IVX]":"upper-roman","[a-z]":"lower-alpha","[A-Z]":"upper-alpha","\\d":"decimal"},u;for(u in o)if(n.getSubsectionSymbol(t).match(new RegExp(u))){i["list-style-type"]=o[u];break}e.attributes["cke-list-style-type"]=i["list-style-type"]}else o={"·":"disc",o:"circle","§":"square"},!i["list-style-type"]&&o[t]&&(i["list-style-type"]=o[t]);n.setListSymbol.removeRedundancies(i,r);(e.attributes.style=CKEDITOR.tools.writeCssText(i))||delete e.attributes.style},setListStart:function(e){for(var t=[],r=0,i=0;i<e.children.length;i++)t.push(e.children[i].attributes["cke-symbol"]||"");t[0]||r++;switch(e.attributes["cke-list-style-type"]){case"lower-roman":case"upper-roman":e.attributes.start=n.toArabic(n.getSubsectionSymbol(t[r]))-r;break;case"lower-alpha":case"upper-alpha":e.attributes.start=n.getSubsectionSymbol(t[r]).replace(/\W/g,"").toLowerCase().charCodeAt(0)-96-r;break;case"decimal":e.attributes.start=parseInt(n.getSubsectionSymbol(t[r]),10)-r||1}"1"==e.attributes.start&&delete e.attributes.start;delete e.attributes["cke-list-style-type"]},numbering:{toNumber:function(e,t){function n(e){e=e.toUpperCase();for(var t=1,n=1;0<e.length;n*=26)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(e.charAt(e.length-1))*n,e=e.substr(0,e.length-1);return t}function r(e){var t=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]];e=e.toUpperCase();for(var n=t.length,r=0,i=0;i<n;++i)for(var s=t[i],o=s[1].length;e.substr(0,o)==s[1];e=e.substr(o))r+=s[0];return r}return"decimal"==t?Number(e):"upper-roman"==t||"lower-roman"==t?r(e.toUpperCase()):"lower-alpha"==t||"upper-alpha"==t?n(e):1},getStyle:function(e){e=e.slice(0,1);var t={i:"lower-roman",v:"lower-roman",x:"lower-roman",l:"lower-roman",m:"lower-roman",I:"upper-roman",V:"upper-roman",X:"upper-roman",L:"upper-roman",M:"upper-roman"}[e];t||(t="decimal",e.match(/[a-z]/)&&(t="lower-alpha"),e.match(/[A-Z]/)&&(t="upper-alpha"));return t}},getSubsectionSymbol:function(e){return(e.match(/([\da-zA-Z]+).?$/)||["placeholder",1])[1]},setListDir:function(e){var t=0,n=0;e.forEach(function(e){"li"==e.name&&("rtl"==(e.attributes.dir||e.attributes.DIR||"").toLowerCase()?n++:t++)},CKEDITOR.ELEMENT_NODE);n>t&&(e.attributes.dir="rtl")},createList:function(e){return(e.attributes["cke-symbol"].match(/([\da-np-zA-NP-Z]).?/)||[])[1]?new CKEDITOR.htmlParser.element("ol"):new CKEDITOR.htmlParser.element("ul")},createLists:function(e){var t,r,i,s=n.convertToRealListItems(e);if(0===s.length)return[];var o=n.groupLists(s);for(e=0;e<o.length;e++){var u=o[e],a=u[0];for(i=0;i<u.length;i++)if(1==u[i].attributes["cke-list-level"]){a=u[i];break}var a=[n.createList(a)],l=a[0],c=[a[0]];l.insertBefore(u[0]);for(i=0;i<u.length;i++){t=u[i];for(r=t.attributes["cke-list-level"];r>a.length;){var h=n.createList(t),p=l.children;0<p.length?p[p.length-1].add(h):(p=new CKEDITOR.htmlParser.element("li",{style:"list-style-type:none"}),p.add(h),l.add(p));a.push(h);c.push(h);l=h;r==a.length&&n.setListSymbol(h,t.attributes["cke-symbol"],r)}for(;r<a.length;)a.pop(),l=a[a.length-1],r==a.length&&n.setListSymbol(l,t.attributes["cke-symbol"],r);t.remove();l.add(t)}a[0].children.length&&(i=a[0].children[0].attributes["cke-symbol"],!i&&1<a[0].children.length&&(i=a[0].children[1].attributes["cke-symbol"]),i&&n.setListSymbol(a[0],i));for(i=0;i<c.length;i++)n.setListStart(c[i]);for(i=0;i<u.length;i++)this.determineListItemValue(u[i])}return s},cleanup:function(e){var t=["cke-list-level","cke-symbol","cke-list-id","cke-indentation","cke-dissolved"],n,r;for(n=0;n<e.length;n++)for(r=0;r<t.length;r++)delete e[n].attributes[t[r]]},determineListItemValue:function(e){if("ol"===e.parent.name){var t=this.calculateValue(e),n=e.attributes["cke-symbol"].match(/[a-z0-9]+/gi),r;n&&(n=n[n.length-1],r=e.parent.attributes["cke-list-style-type"]||this.numbering.getStyle(n),n=this.numbering.toNumber(n,r),n!==t&&(e.attributes.value=n))}},calculateValue:function(e){if(!e.parent)return 1;var t=e.parent;e=e.getIndex();var n=null,r,i,s;for(s=e;0<=s&&null===n;s--)i=t.children[s],i.attributes&&void 0!==i.attributes.value&&(r=s,n=parseInt(i.attributes.value,10));null===n&&(n=void 0!==t.attributes.start?parseInt(t.attributes.start,10):1,r=0);return n+(e-r)},dissolveList:function(e){function t(e){return 50<=e?"l"+t(e-50):40<=e?"xl"+t(e-40):10<=e?"x"+t(e-10):9==e?"ix":5<=e?"v"+t(e-5):4==e?"iv":1<=e?"i"+t(e-1):""}var n,i=[],o=[];e.forEach(function(e){if("li"==e.name){var n=e.children[0];if(n&&n.name&&n.attributes.style&&n.attributes.style.match(/mso-list:/i)){r.pushStylesLower(e,{"list-style-type":!0,display:!0});var u=s.parseCssText(n.attributes.style,!0);r.setStyle(e,"mso-list",u["mso-list"],!0);r.setStyle(n,"mso-list","");if(u.display||u.DISPLAY)u.display?r.setStyle(e,"display",u.display,!0):r.setStyle(e,"display",u.DISPLAY,!0)}e.attributes.style&&e.attributes.style.match(/mso-list:/i)&&(e.name="p",e.attributes["cke-dissolved"]=!0,i.push(e))}if("ul"==e.name||"ol"==e.name){for(n=0;n<e.children.length;n++)if("li"==e.children[n].name){var u=e.attributes.type,a=parseInt(e.attributes.start,10)||1;u||(u=s.parseCssText(e.attributes.style)["list-style-type"]);switch(u){case"disc":u="·";break;case"circle":u="o";break;case"square":u="§";break;case"1":case"decimal":u=a+n+".";break;case"a":case"lower-alpha":u=String.fromCharCode(97+a-1+n)+".";break;case"A":case"upper-alpha":u=String.fromCharCode(65+a-1+n)+".";break;case"i":case"lower-roman":u=t(a+n)+".";break;case"I":case"upper-roman":u=t(a+n).toUpperCase()+".";break;default:u="ul"==e.name?"·":a+n+"."}e.children[n].attributes["cke-symbol"]=u}o.push(e)}},CKEDITOR.NODE_ELEMENT,!1);for(n=i.length-1;0<=n;n--)i[n].insertAfter(e);for(n=o.length-1;0<=n;n--)delete o[n].name},groupLists:function(e){var t,r,i=[[e[0]]],s=i[0];r=e[0];r.attributes["cke-indentation"]=r.attributes["cke-indentation"]||n.getElementIndentation(r);for(t=1;t<e.length;t++){r=e[t];var o=e[t-1];r.attributes["cke-indentation"]=r.attributes["cke-indentation"]||n.getElementIndentation(r);r.previous!==o&&(n.chopDiscontinuousLists(s,i),i.push(s=[]));s.push(r)}n.chopDiscontinuousLists(s,i);return i},chopDiscontinuousLists:function(e,t){for(var r={},i=[[]],o,u=0;u<e.length;u++){var a=r[e[u].attributes["cke-list-level"]],l=this.getListItemInfo(e[u]),c,h;a?(h=a.type.match(/alpha/)&&7==a.index?"alpha":h,h="o"==e[u].attributes["cke-symbol"]&&14==a.index?"alpha":h,c=n.getSymbolInfo(e[u].attributes["cke-symbol"],h),l=this.getListItemInfo(e[u]),(a.type!=c.type||o&&l.id!=o.id&&!this.isAListContinuation(e[u]))&&i.push([])):c=n.getSymbolInfo(e[u].attributes["cke-symbol"]);for(o=parseInt(e[u].attributes["cke-list-level"],10)+1;20>o;o++)r[o]&&delete r[o];r[e[u].attributes["cke-list-level"]]=c;i[i.length-1].push(e[u]);o=l}[].splice.apply(t,[].concat([s.indexOf(t,e),1],i))},isAListContinuation:function(e){var t=e;do if((t=t.previous)&&t.type===CKEDITOR.NODE_ELEMENT){if(void 0===t.attributes["cke-list-level"])break;if(t.attributes["cke-list-level"]===e.attributes["cke-list-level"])return t.attributes["cke-list-id"]===e.attributes["cke-list-id"]}while(t);return!1},getElementIndentation:function(e){e=s.parseCssText(e.attributes.style);if(e.margin||e.MARGIN){e.margin=e.margin||e.MARGIN;var t={styles:{margin:e.margin}};CKEDITOR.filter.transformationsTools.splitMarginShorthand(t);e["margin-left"]=t.styles["margin-left"]}return parseInt(s.convertToPx(e["margin-left"]||"0px"),10)},toArabic:function(e){return e.match(/[ivxl]/i)?e.match(/^l/i)?50+n.toArabic(e.slice(1)):e.match(/^lx/i)?40+n.toArabic(e.slice(1)):e.match(/^x/i)?10+n.toArabic(e.slice(1)):e.match(/^ix/i)?9+n.toArabic(e.slice(2)):e.match(/^v/i)?5+n.toArabic(e.slice(1)):e.match(/^iv/i)?4+n.toArabic(e.slice(2)):e.match(/^i/i)?1+n.toArabic(e.slice(1)):n.toArabic(e.slice(1)):0},getSymbolInfo:function(e,t){var r=e.toUpperCase()==e?"upper-":"lower-",i={"·":["disc",-1],o:["circle",-2],"§":["square",-3]};if(e in i||t&&t.match(/(disc|circle|square)/))return{index:i[e][1],type:i[e][0]};if(e.match(/\d/))return{index:e?parseInt(n.getSubsectionSymbol(e),10):0,type:"decimal"};e=e.replace(/\W/g,"").toLowerCase();return!t&&e.match(/[ivxl]+/i)||t&&"alpha"!=t||"roman"==t?{index:n.toArabic(e),type:r+"roman"}:e.match(/[a-z]/i)?{index:e.charCodeAt(0)-97,type:r+"alpha"}:{index:-1,type:"disc"}},getListItemInfo:function(e){if(void 0!==e.attributes["cke-list-id"])return{id:e.attributes["cke-list-id"],level:e.attributes["cke-list-level"]};var t=s.parseCssText(e.attributes.style)["mso-list"],n={id:"0",level:"1"};t&&(t+=" ",n.level=t.match(/level(.+?)\s+/)[1],n.id=t.match(/l(\d+?)\s+/)[1]);e.attributes["cke-list-level"]=void 0!==e.attributes["cke-list-level"]?e.attributes["cke-list-level"]:n.level;e.attributes["cke-list-id"]=n.id;return n}};n=CKEDITOR.plugins.pastefromword.lists;n.setListSymbol.removeRedundancies=function(e,t){(1===t&&"disc"===e["list-style-type"]||"decimal"===e["list-style-type"])&&delete e["list-style-type"]};CKEDITOR.plugins.pastefromword.createAttributeStack=t})()