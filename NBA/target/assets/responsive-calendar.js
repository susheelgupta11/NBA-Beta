(function(){(function(e){"use strict";var t,n,r;t=function(e,t){var n;this.$element=e;this.options=t;this.weekDays=["sun","mon","tue","wed","thu","fri","sat","sun"];this.time=new Date;this.currentYear=this.time.getFullYear();this.currentMonth=this.time.getMonth();if(this.options.time){n=this.splitDateString(this.options.time);this.currentYear=n.year;this.currentMonth=n.month}this.initialDraw();return null};t.prototype={addLeadingZero:function(e){if(e<10){return"0"+e}else{return""+e}},applyTransition:function(e,t){e.css("transition",t);e.css("-ms-transition","-ms-"+t);e.css("-moz-transition","-moz-"+t);return e.css("-webkit-transition","-webkit-"+t)},applyBackfaceVisibility:function(e){e.css("backface-visibility","hidden");e.css("-ms-backface-visibility","hidden");e.css("-moz-backface-visibility","hidden");return e.css("-webkit-backface-visibility","hidden")},applyTransform:function(e,t){e.css("transform",t);e.css("-ms-transform",t);e.css("-moz-transform",t);return e.css("-webkit-transform",t)},splitDateString:function(e){var t,n,r,i;r=e.split("-");i=parseInt(r[0]);n=parseInt(r[1]-1);t=parseInt(r[2]);return r={year:i,month:n,day:t}},initialDraw:function(){return this.drawDays(this.currentYear,this.currentMonth)},editDays:function(e){var t,n,r,i,s;s=[];for(t in e){r=e[t];this.options.events[t]=e[t];i=this.splitDateString(t);n=this.$element.find('[data-year="'+i.year+'"][data-month="'+(i.month+1)+'"][data-day="'+i.day+'"]').parent(".day");n.removeClass("active");n.find(".badge").remove();n.find("a").removeAttr("href");if(this.currentMonth===i.month||this.options.activateNonCurrentMonths){s.push(this.makeActive(n,r))}else{s.push(void 0)}}return s},clearDays:function(e){var t,n,r,i,s,o;o=[];for(i=0,s=e.length;i<s;i++){t=e[i];delete this.options.events[t];r=this.splitDateString(t);n=this.$element.find('[data-year="'+r.year+'"][data-month="'+(r.month+1)+'"][data-day="'+r.day+'"]').parent(".day");n.removeClass("active");n.find(".badge").remove();o.push(n.find("a").removeAttr("href"))}return o},clearAll:function(){var t,n,r,i,s,o;this.options.events={};n=this.$element.find('[data-group="days"] .day');o=[];for(r=i=0,s=n.length;i<s;r=++i){t=n[r];e(t).removeClass("active");e(t).find(".badge").remove();o.push(e(t).find("a").removeAttr("href"))}return o},setMonth:function(e){var t;t=this.splitDateString(e);return this.currentMonth=this.drawDays(t.year,t.month)},prev:function(){if(this.currentMonth-1<0){this.currentYear=this.currentYear-1;this.currentMonth=11}else{this.currentMonth=this.currentMonth-1}this.drawDays(this.currentYear,this.currentMonth);if(this.options.onMonthChange){this.options.onMonthChange.call(this)}return null},next:function(){if(this.currentMonth+1>11){this.currentYear=this.currentYear+1;this.currentMonth=0}else{this.currentMonth=this.currentMonth+1}this.drawDays(this.currentYear,this.currentMonth);if(this.options.onMonthChange){this.options.onMonthChange.call(this)}return null},curr:function(){this.currentYear=this.time.getFullYear();this.currentMonth=this.time.getMonth();this.drawDays(this.currentYear,this.currentMonth);if(this.options.onMonthChange){this.options.onMonthChange.call(this)}return null},addOthers:function(t,n){var r;if(typeof n==="object"){if(n.number!=null){r=e("<span></span>").html(n.number).addClass("badge");if(n.badgeClass!=null){r.addClass(n.badgeClass)}t.append(r)}if(n.url){t.find("a").attr("href",n.url)}}return t},makeActive:function(e,t){var n,r,i,s,o;if(t){if(t["class"]){n=t["class"].split(" ");for(i=s=0,o=n.length;s<o;i=++s){r=n[i];e.addClass(r)}}else{e.addClass("active")}e=this.addOthers(e,t)}return e},getDaysInMonth:function(e,t){return(new Date(e,t+1,0)).getDate()},drawDay:function(t,n,r,i,s){var o,u,a,f,l,c;f=e("<div></div>").addClass("day");u=new Date;u.setHours(0,0,0,0);l=new Date(n,r-1,i);if(l.getTime()<u.getTime()){c="past"}else if(l.getTime()===u.getTime()){c="today"}else{c="future"}f.addClass(this.weekDays[s%7]);f.addClass(c);a=n+"-"+this.addLeadingZero(r)+"-"+this.addLeadingZero(i);if(i<=0||i>t){o=new Date(n,r-1,i);i=o.getDate();r=o.getMonth()+1;n=o.getFullYear();f.addClass("not-current").addClass(c);if(this.options.activateNonCurrentMonths){a=n+"-"+this.addLeadingZero(r)+"-"+this.addLeadingZero(i)}}f.append(e("<a>"+i+"</a>").attr("data-day",i).attr("data-month",r).attr("data-year",n));if(this.options.monthChangeAnimation){this.applyTransform(f,"rotateY(180deg)");this.applyBackfaceVisibility(f)}f=this.makeActive(f,this.options.events[a]);return this.$element.find('[data-group="days"]').append(f)},drawDays:function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;v=this;m=new Date(t,n);r=m.getMonth();p=m.getMonth()+1;y=m.getFullYear();m.setDate(1);f=this.options.startFromSunday?m.getDay()+1:m.getDay()||7;c=this.getDaysInMonth(t,n);g=0;if(this.options.monthChangeAnimation){o=this.$element.find('[data-group="days"] .day');for(l=b=0,w=o.length;b<w;l=++b){i=o[l];u=l*.01;this.applyTransition(e(i),"transform .5s ease "+u+"s");this.applyTransform(e(i),"rotateY(180deg)");this.applyBackfaceVisibility(e(i));g=(u+.1)*1e3}}s=2;if(this.options.allRows){h=42}else{d=Math.ceil((f-(s-1)+c)/7);h=d*7}this.$element.find("[data-head-year]").html(m.getFullYear());this.$element.find("[data-head-month]").html(this.options.translateMonths[m.getMonth()]);a=function(){var t,n;v.$element.find('[data-group="days"]').empty();t=s-f;l=v.options.startFromSunday?0:1;while(t<h-f+s){v.drawDay(c,y,p,t,l);t=t+1;l=l+1}n=function(){var t,n;o=v.$element.find('[data-group="days"] .day');for(l=t=0,n=o.length;t<n;l=++t){i=o[l];v.applyTransition(e(i),"transform .5s ease "+l*.01+"s");v.applyTransform(e(i),"rotateY(0deg)")}if(v.options.onDayClick){v.$element.find('[data-group="days"] .day a').click(function(){return v.options.onDayClick.call(this,v.options.events)})}if(v.options.onDayHover){v.$element.find('[data-group="days"] .day a').hover(function(){return v.options.onDayHover.call(this,v.options.events)})}if(v.options.onActiveDayClick){v.$element.find('[data-group="days"] .day.active a').click(function(){return v.options.onActiveDayClick.call(this,v.options.events)})}if(v.options.onActiveDayHover){return v.$element.find('[data-group="days"] .day.active a').hover(function(){return v.options.onActiveDayHover.call(this,v.options.events)})}};return setTimeout(n,0)};setTimeout(a,g);return r}};e.fn.responsiveCalendar=function(n,r){var i,s,o;s=e.extend({},e.fn.responsiveCalendar.defaults,typeof n==="object"&&n);o={next:"next",prev:"prev",edit:"editDays",clear:"clearDays",clearAll:"clearAll",getYearMonth:"getYearMonth",jump:"jump",curr:"curr"};i=function(n){var r;s=e.metadata?e.extend({},s,n.metadata()):s;n.data("calendar",r=new t(n,s));if(s.onInit){s.onInit.call(r)}return n.find("[data-go]").click(function(){if(e(this).data("go")==="prev"){r.prev()}if(e(this).data("go")==="next"){return r.next()}})};return this.each(function(){var t,s;t=e(this);s=t.data("calendar");if(!s){i(t)}else if(typeof n==="string"){if(o[n]!=null){s[o[n]](r)}else{s.setMonth(n)}}else if(typeof n==="number"){s.jump(Math.abs(n)+1)}return null})};e.fn.responsiveCalendar.defaults={translateMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],events:{},time:void 0,allRows:true,startFromSunday:false,activateNonCurrentMonths:false,monthChangeAnimation:true,onInit:void 0,onDayClick:void 0,onDayHover:void 0,onActiveDayClick:void 0,onActiveDayHover:void 0,onMonthChange:void 0};r=e('[data-spy="responsive-calendar"]');if(r.length){n={};if(r.data("translate-months")!=null){n.translateMonths=r.data("translate-months").split(",")}if(r.data("time")!=null){n.time=r.data("time")}if(r.data("all-rows")!=null){n.allRows=r.data("all-rows")}if(r.data("start-from-sunday")!=null){n.startFromSunday=r.data("start-from-sunday")}if(r.data("activate-non-current-months")!=null){n.activateNonCurrentMonths=r.data("activate-non-current-months")}if(r.data("month-change-animation")!=null){n.monthChangeAnimation=r.data("month-change-animation")}return r.responsiveCalendar(n)}})(jQuery)}).call(this)